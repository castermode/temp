<!-- 

ç¼–å†™ä»£ç ï¼Œå®ç°ä¸€ä¸ªwebé¡µé¢ï¼Œå±•ç¤ºdashboard_server.pyçš„æŸ¥è¯¢ç»“æœ

ä½¿ç”¨html+css+javascriptå®ç°
ä½¿ç”¨ ajax è¯·æ±‚ dashboard_server.py çš„æŸ¥è¯¢ç»“æœ

é¡µé¢ä»ä¸Šåˆ°ä¸‹åˆ†ä¸º 6 ä¸ªéƒ¨åˆ†ï¼š

ç¬¬ä¸€ä¸ªéƒ¨åˆ†ï¼šå±•ç¤º "kemem dashboard"

ç¬¬äºŒä¸ªéƒ¨åˆ†ï¼šå±•ç¤º sqlite æŸ¥è¯¢ç»“æœ
æ¥å£æ•°æ®ç¤ºä¾‹ï¼š
curl http://127.0.0.1:8888/query/db
{"success":true,"count":6,"data":[{"id":"4af52f75-8374-41ce-9950-475b3b0711d2","memory_id":"3633a14d-a133-4cec-954e-e1c8fcfff657","old_memory":null,"new_memory":"æ©˜å­å¯Œå«è¥å…»","event":"ADD","created_at":"2025-11-10T01:17:48.096066-08:00","updated_at":null,"is_deleted":0,"actor_id":null,"role":null},{"id":"2c6cb1ba-23d4-4cec-8957-6ea4dbe4a329","memory_id":"948929fe-3783-4632-95a1-ba4d1f4f72cb","old_memory":null,"new_memory":"å–œæ¬¢åƒæ©˜å­","event":"ADD","created_at":"2025-11-10T01:17:48.091644-08:00","updated_at":null,"is_deleted":0,"actor_id":null,"role":null},{"id":"30dd35e3-d309-4967-bdc3-325fc6163403","memory_id":"fd900668-1fed-4eef-9a80-3bd18a05cdb3","old_memory":null,"new_memory":"å–œæ¬¢åƒé¦™è•‰","event":"ADD","created_at":"2025-11-10T01:17:42.508086-08:00","updated_at":null,"is_deleted":0,"actor_id":null,"role":null},{"id":"b1536858-c47e-47fe-a7ba-3856f72dd1f4","memory_id":"9783a0e2-6273-418d-a20e-d58289383700","old_memory":null,"new_memory":"è‹¹æœå¾ˆç”œ","event":"ADD","created_at":"2025-11-10T01:17:36.986940-08:00","updated_at":null,"is_deleted":0,"actor_id":null,"role":null},{"id":"89dba432-7bb2-4c91-927d-47a80daba4f6","memory_id":"8367001d-f349-41e6-85d2-d5ad41c14393","old_memory":null,"new_memory":"å–œæ¬¢åƒè‹¹æœ","event":"ADD","created_at":"2025-11-10T01:17:36.984254-08:00","updated_at":null,"is_deleted":0,"actor_id":null,"role":null},{"id":"deab2c76-e5e9-466e-b21a-3bd805eef498","memory_id":"8367001d-f349-41e6-85d2-d5ad41c14393","old_memory":"å–œæ¬¢åƒè‹¹æœ","new_memory":null,"event":"DELETE","created_at":null,"updated_at":null,"is_deleted":1,"actor_id":null,"role":null}]}


ç¬¬ä¸‰ä¸ªéƒ¨åˆ†ï¼Œå±•ç¤º å‘é‡æ•°æ®åº“æŸ¥è¯¢ç»“æœ
æ¥å£æ•°æ®ç¤ºä¾‹ï¼š
curl http://127.0.0.1:8888/query/vectordb
{"success":true,"count":4,"collection_info":{"name":1536,"points_count":4,"vectors_count":null},"data":[{"id":"3633a14d-a133-4cec-954e-e1c8fcfff657","payload":{"user_id":"user_001","data":"æ©˜å­å¯Œå«è¥å…»","hash":"e390cef06dd982772f7e189f694461a7","created_at":"2025-11-10T01:17:48.096066-08:00"}},{"id":"948929fe-3783-4632-95a1-ba4d1f4f72cb","payload":{"user_id":"user_001","data":"å–œæ¬¢åƒæ©˜å­","hash":"439fe21480d5552cfd8056c26cd6f0b3","created_at":"2025-11-10T01:17:48.091644-08:00"}},{"id":"9783a0e2-6273-418d-a20e-d58289383700","payload":{"user_id":"user_001","data":"è‹¹æœå¾ˆç”œ","hash":"72882b81533eb182c5998d6f13199fe8","created_at":"2025-11-10T01:17:36.986940-08:00"}},{"id":"fd900668-1fed-4eef-9a80-3bd18a05cdb3","payload":{"user_id":"user_001","data":"å–œæ¬¢åƒé¦™è•‰","hash":"553cb759b0671e815b97f3aa5df02887","created_at":"2025-11-10T01:17:42.508086-08:00"}}]}%


ç¬¬å››éƒ¨åˆ†ï¼Œå±•ç¤º å›¾æ•°æ®åº“æŸ¥è¯¢ç»“æœ
æ¥å£æ•°æ®ç¤ºä¾‹ï¼š
curl http://127.0.0.1:8888/query/graphdb
{"success":true,"nodes_count":10,"relationships_count":5,"data":{"nodes":[{"id":null,"user_id":"user_001","name":"user_id:_user_001","mentions":2,"created":"2025-11-10 09:15:26.130000"},{"id":"1","user_id":"user_001","name":"è‹¹æœ","mentions":5,"created":"2025-11-10 09:15:26.130000"},{"id":"2","user_id":"user_001","name":"ç”œ","mentions":1,"created":"2025-11-10 09:15:26.847000"},{"id":"3","user_id":"user_001","name":"æˆ‘","mentions":2,"created":"2025-11-10 09:17:39.232000"},{"id":"4","user_id":"user_001","name":"å¾ˆç”œ","mentions":1,"created":"2025-11-10 09:17:39.912000"},{"id":"5","user_id":"user_001","name":"é¦™è•‰","mentions":2,"created":"2025-11-10 09:17:44.277000"},{"id":"6","user_id":"user_001","name":"èƒ½é‡","mentions":1,"created":"2025-11-10 09:17:44.809000"},{"id":"7","user_id":"user_001","name":"æ©˜å­","mentions":2,"created":"2025-11-10 09:17:49.488000"},{"id":"8","user_id":"user_001","name":"è¥å…»","mentions":1,"created":"2025-11-10 09:17:50.114000"},{"id":"9","user_id":"user_001","name":"user_001","mentions":1,"created":"2025-11-10 09:17:53.767000"}],"relationships":[{"source":"user_id:_user_001","relationship":"likes","destination":"æ©˜å­","mentions":1,"created":"2025-11-10 09:17:49.488000","updated":null},{"source":"æˆ‘","relationship":"likes","destination":"é¦™è•‰","mentions":1,"created":"2025-11-10 09:17:44.277000","updated":null},{"source":"é¦™è•‰","relationship":"has","destination":"èƒ½é‡","mentions":1,"created":"2025-11-10 09:17:44.809000","updated":null},{"source":"æ©˜å­","relationship":"contains","destination":"è¥å…»","mentions":1,"created":"2025-11-10 09:17:50.114000","updated":null},{"source":"user_001","relationship":"dislikes","destination":"è‹¹æœ","mentions":1,"created":"2025-11-10 09:17:53.767000","updated":null}]}}%

ç¬¬äº”éƒ¨åˆ†ï¼Œå°†ç¬¬å››éƒ¨åˆ†å›¾æ•°æ®åº“çš„ç»“æœé€šè¿‡å›¾è°±å±•ç¤ºå‡ºæ¥

ç¬¬å…­éƒ¨åˆ†ï¼Œå±•ç¤ºç”¨æˆ·ç”»åƒã€‚å±•ç¤ºçš„å†…å®¹ä¸º â€œç”¨æˆ·1ç”»åƒï¼›ç”¨æˆ·2ç”»åƒï¼›ç”¨æˆ·3ç”»åƒâ€ï¼Œä¸éœ€è¦è°ƒç”¨åç«¯æ¥å£ï¼Œç›´æ¥å±•ç¤ºé™æ€å†…å®¹â€œç”¨æˆ·1ç”»åƒï¼›ç”¨æˆ·2ç”»åƒï¼›ç”¨æˆ·3ç”»åƒâ€å°±è¡Œ

-->

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KeMem Dashboard</title>
    <!-- Vis.js ç½‘ç»œå›¾åº“ -->
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ‡é¢˜ */
        .header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            color: #667eea;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* ç¬¬äºŒéƒ¨åˆ†ï¼šSQLite æŸ¥è¯¢ç»“æœ */
        .section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .section-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .refresh-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .refresh-btn:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .stats {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat-card {
            flex: 1;
            min-width: 150px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .stat-card .value {
            font-size: 2em;
            font-weight: bold;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
            font-size: 1.2em;
        }

        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #c33;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        td {
            padding: 12px;
            border-bottom: 1px solid #eee;
            color: #333;
        }

        tr:hover {
            background: #f8f9ff;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-add {
            background: #d4edda;
            color: #155724;
        }

        .badge-delete {
            background: #f8d7da;
            color: #721c24;
        }

        .badge-update {
            background: #d1ecf1;
            color: #0c5460;
        }

        .text-muted {
            color: #999;
            font-style: italic;
        }

        .text-truncate {
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .timestamp {
            font-size: 0.9em;
            color: #666;
        }

        /* ç¬¬ä¸‰ã€ç¬¬å››éƒ¨åˆ† */
        .placeholder-section {
            background: white;
            border-radius: 15px;
            padding: 60px 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .placeholder-section h2 {
            font-size: 3em;
            color: #667eea;
            font-weight: 700;
        }

        /* ç¬¬äº”éƒ¨åˆ†ï¼šå›¾è°±å¯è§†åŒ– */
        #graph-visualization {
            width: 100%;
            height: 600px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: #fafafa;
            position: relative;
        }

        .graph-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .graph-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .graph-btn:hover {
            background: #5568d3;
            transform: translateY(-1px);
        }

        .graph-btn.secondary {
            background: #764ba2;
        }

        .graph-btn.secondary:hover {
            background: #653a91;
        }

        .graph-legend {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            padding: 15px;
            background: #f8f9ff;
            border-radius: 8px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #333;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .section {
                padding: 20px;
            }

            .stat-card {
                min-width: 100%;
            }

            table {
                font-size: 0.9em;
            }

            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ç¬¬ä¸€éƒ¨åˆ†ï¼šæ ‡é¢˜ -->
        <div class="header">
            <h1>ğŸ§  KeMem Dashboard</h1>
        </div>

        <!-- ç¬¬äºŒéƒ¨åˆ†ï¼šSQLite æŸ¥è¯¢ç»“æœ -->
        <div class="section">
            <div class="section-title">
                <span>ğŸ“Š Memory History</span>
                <button class="refresh-btn" onclick="loadData()">ğŸ”„ åˆ·æ–°æ•°æ®</button>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="label">æ€»è®°å½•æ•°</div>
                    <div class="value" id="total-count">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">ADD äº‹ä»¶</div>
                    <div class="value" id="add-count">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">DELETE äº‹ä»¶</div>
                    <div class="value" id="delete-count">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">UPDATE äº‹ä»¶</div>
                    <div class="value" id="update-count">-</div>
                </div>
            </div>

            <div id="data-container">
                <div class="loading">â³ æ­£åœ¨åŠ è½½æ•°æ®...</div>
            </div>
        </div>

        <!-- ç¬¬ä¸‰éƒ¨åˆ†ï¼šå‘é‡æ•°æ®åº“æŸ¥è¯¢ç»“æœ -->
        <div class="section">
            <div class="section-title">
                <span>ğŸ”® Vector</span>
                <button class="refresh-btn" onclick="loadVectorData()">ğŸ”„ åˆ·æ–°æ•°æ®</button>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="label">å‘é‡æ€»æ•°</div>
                    <div class="value" id="vector-total-count">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">é›†åˆç‚¹æ•°</div>
                    <div class="value" id="vector-points-count">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">å‘é‡ç»´åº¦</div>
                    <div class="value" id="vector-dimension">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">ç”¨æˆ·æ•°æ®</div>
                    <div class="value" id="vector-user-count">-</div>
                </div>
            </div>

            <div id="vector-data-container">
                <div class="loading">â³ æ­£åœ¨åŠ è½½æ•°æ®...</div>
            </div>
        </div>

        <!-- ç¬¬å››éƒ¨åˆ†ï¼šå›¾æ•°æ®åº“æŸ¥è¯¢ç»“æœ -->
        <div class="section">
            <div class="section-title">
                <span>ğŸ•¸ï¸ Graph</span>
                <button class="refresh-btn" onclick="loadGraphData()">ğŸ”„ åˆ·æ–°æ•°æ®</button>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="label">èŠ‚ç‚¹æ€»æ•°</div>
                    <div class="value" id="graph-nodes-count">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">å…³ç³»æ€»æ•°</div>
                    <div class="value" id="graph-relationships-count">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">å®ä½“æ•°</div>
                    <div class="value" id="graph-entities-count">-</div>
                </div>
                <div class="stat-card">
                    <div class="label">è¿æ¥æ•°</div>
                    <div class="value" id="graph-connections-count">-</div>
                </div>
            </div>

            <div id="graph-data-container">
                <div class="loading">â³ æ­£åœ¨åŠ è½½å›¾æ•°æ®...</div>
            </div>
        </div>

        <!-- ç¬¬äº”éƒ¨åˆ†ï¼šå›¾è°±å¯è§†åŒ– -->
        <div class="section">
            <div class="section-title">
                <span>ğŸ¨ çŸ¥è¯†å›¾è°±å¯è§†åŒ–</span>
                <button class="refresh-btn" onclick="loadGraphVisualization()">ğŸ”„ åˆ·æ–°å›¾è°±</button>
            </div>

            <div class="graph-controls">
                <button class="graph-btn" onclick="fitGraphView()">ğŸ“ é€‚åº”è§†å›¾</button>
                <button class="graph-btn" onclick="resetGraphPhysics()">ğŸ”„ é‡æ–°å¸ƒå±€</button>
                <button class="graph-btn secondary" onclick="togglePhysics()">âš™ï¸ åˆ‡æ¢ç‰©ç†å¼•æ“</button>
                <button class="graph-btn secondary" onclick="exportGraphImage()">ğŸ“¸ å¯¼å‡ºå›¾ç‰‡</button>
            </div>

            <div id="graph-vis-container">
                <div id="graph-visualization">
                    <div class="loading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">
                        â³ æ­£åœ¨åŠ è½½å›¾è°±...
                    </div>
                </div>
            </div>

            <div class="graph-legend">
                <div class="legend-item">
                    <div class="legend-color" style="background: #97C2FC;"></div>
                    <span>å®ä½“èŠ‚ç‚¹</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FB7E81;"></div>
                    <span>ç”¨æˆ·èŠ‚ç‚¹</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #7BE141;"></div>
                    <span>likes å…³ç³»</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #FFA807;"></div>
                    <span>dislikes å…³ç³»</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background: #6E6EFD;"></div>
                    <span>å…¶ä»–å…³ç³»</span>
                </div>
            </div>
        </div>

        <!-- ç¬¬å…­éƒ¨åˆ†ï¼šç”¨æˆ·ç”»åƒ -->
        <div class="section">
            <div class="section-title">
                <span>ğŸ‘¤ ç”¨æˆ·ç”»åƒ</span>
            </div>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                <!-- ç”¨æˆ·1ç”»åƒ -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);">
                    <h3 style="margin-bottom: 15px; font-size: 1.5em; border-bottom: 2px solid rgba(255, 255, 255, 0.3); padding-bottom: 10px;">
                        ğŸ‘¤ ç”¨æˆ·Carolineç”»åƒ
                    </h3>
                    <pre style="white-space: pre-wrap; margin: 0; font-family: 'Consolas', 'Monaco', 'Courier New', monospace; line-height: 1.6; font-size: 0.95em; background: rgba(0, 0, 0, 0.1); border-radius: 8px; padding: 15px; overflow-x: auto;">{
  "name": "Caroline",
  "gender_identity": "å¥³æ€§ï¼Œè·¨æ€§åˆ«è€…",
  "age_group": "å¹´è½»æˆäººï¼ˆ20-30å²ï¼‰",
  "occupation_status": "ç§¯ææ¢ç´¢èŒä¸šæ–¹å‘ï¼Œå€¾å‘äºå¿ƒç†å¥åº·æˆ–å’¨è¯¢ç±»å·¥ä½œ",
  "personality_traits": [
    "æœ‰å‹‡æ°”",
    "å¯Œæœ‰åŒç†å¿ƒ",
    "å¼€æ”¾åŒ…å®¹"
  ],
  "interests": [
    "LGBTQ ç¤¾åŒºæ”¯æŒ",
    "å¿ƒç†å¥åº·",
    "è‡ªæˆ‘æˆé•¿",
    "è‰ºæœ¯ï¼ˆç»˜ç”»ï¼‰"
  ],
  "values": [
    "æ¥çº³å’ŒåŒ…å®¹",
    "è‡ªæˆ‘è¡¨è¾¾",
    "æ”¯æŒå¤šå…ƒæ€§"
  ],
  "life_status": "ç§¯æå¯»æ±‚è‡ªæˆ‘è®¤åŒä¸æˆé•¿ï¼Œå‚ä¸æ”¯æŒå›¢ä½“ï¼Œæ³¨é‡ä¸ªäººæƒ…æ„Ÿå’Œå¿ƒç†å¥åº·",
  "social_traits": "å–„äºè¡¨è¾¾ï¼Œé‡è§†ç¤¾äº¤æ”¯æŒï¼Œæ„¿æ„åˆ†äº«è‡ªå·±çš„ç»å†",
  "topics_of_interest": [
    "LGBTQ æƒç›Š",
    "å¿ƒç†å¥åº·",
    "è‡ªæˆ‘è®¤åŒ",
    "è‰ºæœ¯è¡¨è¾¾"
  ],
  "personal_goals": [
    "æˆä¸ºå¿ƒç†å’¨è¯¢å¸ˆæˆ–ç›¸å…³ä¸“ä¸šäººå£«",
    "ç»§ç»­å­¦ä¹ è‡ªæˆ‘æ¥çº³ä¸è¡¨è¾¾",
    "ç§¯æå‚ä¸æ”¯æŒç¤¾åŒº"
  ]
}</pre>
                </div>

                <!-- ç”¨æˆ·2ç”»åƒ -->
                <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);">
                    <h3 style="margin-bottom: 15px; font-size: 1.5em; border-bottom: 2px solid rgba(255, 255, 255, 0.3); padding-bottom: 10px;">
                        ğŸ‘¤ ç”¨æˆ·Melanieç”»åƒ
                    </h3>
                    <pre style="white-space: pre-wrap; margin: 0; font-family: 'Consolas', 'Monaco', 'Courier New', monospace; line-height: 1.6; font-size: 0.95em; background: rgba(0, 0, 0, 0.1); border-radius: 8px; padding: 15px; overflow-x: auto;">{
  "name": "Melanie",
  "gender_identity": "å¥³æ€§",
  "age_group": "ä¸­å¹´ï¼ˆ30-40å²ï¼‰",
  "occupation_status": "å®¶åº­ä¸»å¦‡ï¼Œå…¼å…·è‰ºæœ¯çˆ±å¥½è€…ï¼Œå¯èƒ½ä»äº‹å…¼èŒæˆ–è‡ªç”±èŒä¸š",
  "personality_traits": [
    "æœ‰åˆ›é€ åŠ›",
    "å…³å¿ƒå®¶åº­",
    "å–„äºè¡¨è¾¾æ„Ÿå—"
  ],
  "interests": [
    "ç»˜ç”»ä¸è‰ºæœ¯",
    "å®¶åº­ç”Ÿæ´»",
    "è‡ªæˆ‘æ”¾æ¾ä¸å¨±ä¹",
    "å­©å­æ•™è‚²"
  ],
  "values": [
    "å®¶åº­ä»·å€¼",
    "åˆ›é€ æ€§è¡¨è¾¾",
    "å¹³è¡¡ç”Ÿæ´»"
  ],
  "life_status": "å¹³è¡¡å®¶åº­å’Œä¸ªäººå…´è¶£ï¼Œæ³¨é‡è‡ªæˆ‘è¡¨è¾¾å’Œæƒ…æ„Ÿæ”¾æ¾",
  "social_traits": "æ¸©å’Œã€å–„äºæ²Ÿé€šï¼Œé‡è§†å®¶åº­å…³ç³»ä¸æœ‹å‹äº¤æµ",
  "topics_of_interest": [
    "è‰ºæœ¯åˆ›ä½œ",
    "å®¶åº­ç”Ÿæ´»",
    "è‡ªæˆ‘è¡¨è¾¾",
    "å­©å­æ•™è‚²"
  ],
  "personal_goals": [
    "ç»§ç»­æå‡ç»˜ç”»æŠ€å·§",
    "ä¿æŒå®¶åº­ä¸ä¸ªäººå…´è¶£çš„å¹³è¡¡",
    "é€šè¿‡è‰ºæœ¯å®ç°è‡ªæˆ‘è¡¨è¾¾"
  ]
}</pre>
                </div>

                <!-- ç”¨æˆ·3ç”»åƒ -->
                <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);">
                    <h3 style="margin-bottom: 15px; font-size: 1.5em; border-bottom: 2px solid rgba(255, 255, 255, 0.3); padding-bottom: 10px;">
                        ğŸ‘¤ ç”¨æˆ·Bruceç”»åƒ
                    </h3>
                    <pre style="white-space: pre-wrap; margin: 0; font-family: 'Consolas', 'Monaco', 'Courier New', monospace; line-height: 1.6; font-size: 0.95em; background: rgba(0, 0, 0, 0.1); border-radius: 8px; padding: 15px; overflow-x: auto;">{
  "name": "Bruce",
  "gender_identity": "ç”·æ€§",
  "age_group": "ä¸­å¹´ï¼ˆ35-45å²ï¼‰",
  "occupation_status": "é«˜ä¸­æ•°å­¦æ•™å¸ˆï¼Œä»äº‹æ•™è‚²å·¥ä½œ10ä½™å¹´",
  "personality_traits": [
    "é€»è¾‘æ€ç»´å¼º",
    "æœ‰è€å¿ƒ",
    "è®¤çœŸè´Ÿè´£",
    "å–„äºå¼•å¯¼"
  ],
  "interests": [
    "æ•°å­¦ç ”ç©¶",
    "æ•™è‚²æ–¹æ³•æ¢ç´¢",
    "æ•°å­¦ç«èµ›è¾…å¯¼",
    "é˜…è¯»æ•™è‚²ç±»ä¹¦ç±"
  ],
  "values": [
    "æ•™è‚²å…¬å¹³",
    "çŸ¥è¯†ä¼ æ’­",
    "é€»è¾‘æ€ç»´åŸ¹å…»",
    "å› ææ–½æ•™"
  ],
  "life_status": "ä¸“æ³¨äºæ•™å­¦å·¥ä½œï¼Œè‡´åŠ›äºæå‡æ•™å­¦è´¨é‡ï¼Œå…³æ³¨å­¦ç”Ÿçš„æ•°å­¦æ€ç»´å‘å±•",
  "social_traits": "å–„äºè®²è§£ï¼Œè€å¿ƒå€¾å¬å­¦ç”Ÿé—®é¢˜ï¼Œæ³¨é‡ä¸å­¦ç”Ÿå’Œå®¶é•¿çš„æ²Ÿé€š",
  "topics_of_interest": [
    "æ•°å­¦æ•™è‚²æ–¹æ³•",
    "å­¦ç”Ÿæ€ç»´åŸ¹å…»",
    "æ•™å­¦åˆ›æ–°",
    "æ•°å­¦ç«èµ›"
  ],
  "personal_goals": [
    "å¸®åŠ©æ›´å¤šå­¦ç”Ÿå»ºç«‹æ•°å­¦è‡ªä¿¡",
    "æ¢ç´¢æ›´æœ‰æ•ˆçš„æ•™å­¦æ–¹æ³•",
    "åŸ¹å…»å‡ºæ•°å­¦ç«èµ›è·å¥–å­¦ç”Ÿ",
    "æˆä¸ºä¼˜ç§€çš„æ•°å­¦æ•™è‚²å·¥ä½œè€…"
  ]
}</pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API é…ç½®
        const API_BASE_URL = 'http://127.0.0.1:8888';

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è·å–æ•°æ®
        window.addEventListener('DOMContentLoaded', function() {
            loadData();
            loadVectorData();
            loadGraphData();
            loadGraphVisualization();
        });

        // å…¨å±€å˜é‡ï¼šä¿å­˜ç½‘ç»œå›¾å®ä¾‹
        let networkInstance = null;
        let graphDataCache = null;
        let physicsEnabled = true;

        // åŠ è½½æ•°æ®
        async function loadData() {
            const container = document.getElementById('data-container');
            container.innerHTML = '<div class="loading">â³ æ­£åœ¨åŠ è½½æ•°æ®...</div>';

            try {
                // å‘é€ AJAX è¯·æ±‚
                const response = await fetch(`${API_BASE_URL}/query/db`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();

                if (result.success && result.data) {
                    updateStats(result.data);
                    renderTable(result.data);
                } else {
                    throw new Error('æ•°æ®æ ¼å¼é”™è¯¯');
                }
            } catch (error) {
                console.error('è·å–æ•°æ®å¤±è´¥:', error);
                container.innerHTML = `
                    <div class="error">
                        âŒ åŠ è½½æ•°æ®å¤±è´¥: ${error.message}
                        <br><br>
                        è¯·ç¡®ä¿ï¼š
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>dashboard_server.py å·²å¯åŠ¨ï¼ˆè¿è¡Œ: python dashboard_server.pyï¼‰</li>
                            <li>æœåŠ¡å™¨åœ°å€æ­£ç¡®ï¼ˆ${API_BASE_URL}ï¼‰</li>
                            <li>æ•°æ®åº“æ–‡ä»¶å­˜åœ¨</li>
                        </ul>
                    </div>
                `;
            }
        }

        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        function updateStats(data) {
            const totalCount = data.length;
            const addCount = data.filter(item => item.event === 'ADD').length;
            const deleteCount = data.filter(item => item.event === 'DELETE').length;
            const updateCount = data.filter(item => item.event === 'UPDATE').length;

            document.getElementById('total-count').textContent = totalCount;
            document.getElementById('add-count').textContent = addCount;
            document.getElementById('delete-count').textContent = deleteCount;
            document.getElementById('update-count').textContent = updateCount;
        }

        // æ¸²æŸ“è¡¨æ ¼
        function renderTable(data) {
            const container = document.getElementById('data-container');

            if (data.length === 0) {
                container.innerHTML = '<div class="loading">ğŸ“­ æš‚æ— æ•°æ®</div>';
                return;
            }

            let html = `
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Memory ID</th>
                                <th>äº‹ä»¶ç±»å‹</th>
                                <th>æ—§è®°å¿†</th>
                                <th>æ–°è®°å¿†</th>
                                <th>åˆ›å»ºæ—¶é—´</th>
                                <th>çŠ¶æ€</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            data.forEach(item => {
                const eventBadge = getEventBadge(item.event);
                const statusBadge = item.is_deleted ? '<span class="badge badge-delete">å·²åˆ é™¤</span>' : '<span class="badge badge-add">æ­£å¸¸</span>';
                
                html += `
                    <tr>
                        <td><span class="text-truncate" title="${item.id}">${item.id.substring(0, 8)}...</span></td>
                        <td><span class="text-truncate" title="${item.memory_id}">${item.memory_id ? item.memory_id.substring(0, 8) + '...' : '-'}</span></td>
                        <td>${eventBadge}</td>
                        <td>${item.old_memory ? `<span class="text-truncate" title="${item.old_memory}">${item.old_memory}</span>` : '<span class="text-muted">æ— </span>'}</td>
                        <td>${item.new_memory ? `<span class="text-truncate" title="${item.new_memory}">${item.new_memory}</span>` : '<span class="text-muted">æ— </span>'}</td>
                        <td><span class="timestamp">${formatDateTime(item.created_at)}</span></td>
                        <td>${statusBadge}</td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
            `;

            container.innerHTML = html;
        }

        // è·å–äº‹ä»¶ç±»å‹å¾½ç« 
        function getEventBadge(event) {
            switch (event) {
                case 'ADD':
                    return '<span class="badge badge-add">ADD</span>';
                case 'DELETE':
                    return '<span class="badge badge-delete">DELETE</span>';
                case 'UPDATE':
                    return '<span class="badge badge-update">UPDATE</span>';
                default:
                    return `<span class="badge">${event}</span>`;
            }
        }

        // æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
        function formatDateTime(dateStr) {
            if (!dateStr) return '-';
            
            try {
                const date = new Date(dateStr);
                return date.toLocaleString('zh-CN', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
            } catch (e) {
                return dateStr;
            }
        }

        // ========== å‘é‡æ•°æ®åº“ç›¸å…³å‡½æ•° ==========

        // åŠ è½½å‘é‡æ•°æ®åº“æ•°æ®
        async function loadVectorData() {
            const container = document.getElementById('vector-data-container');
            container.innerHTML = '<div class="loading">â³ æ­£åœ¨åŠ è½½å‘é‡æ•°æ®...</div>';

            try {
                // å‘é€ AJAX è¯·æ±‚
                const response = await fetch(`${API_BASE_URL}/query/vectordb`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();

                if (result.success && result.data) {
                    updateVectorStats(result);
                    renderVectorTable(result.data);
                } else {
                    throw new Error('æ•°æ®æ ¼å¼é”™è¯¯');
                }
            } catch (error) {
                console.error('è·å–å‘é‡æ•°æ®å¤±è´¥:', error);
                container.innerHTML = `
                    <div class="error">
                        âŒ åŠ è½½å‘é‡æ•°æ®å¤±è´¥: ${error.message}
                        <br><br>
                        è¯·ç¡®ä¿ï¼š
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>dashboard_server.py å·²å¯åŠ¨</li>
                            <li>å‘é‡æ•°æ®åº“æ–‡ä»¶å­˜åœ¨</li>
                            <li>Qdrant å®¢æˆ·ç«¯å·²å®‰è£…</li>
                        </ul>
                    </div>
                `;
            }
        }

        // æ›´æ–°å‘é‡æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯
        function updateVectorStats(result) {
            const totalCount = result.count || 0;
            const pointsCount = result.collection_info?.points_count || 0;
            const dimension = result.collection_info?.name || '-';
            
            // ç»Ÿè®¡ä¸åŒç”¨æˆ·
            const userSet = new Set();
            if (result.data) {
                result.data.forEach(item => {
                    if (item.payload && item.payload.user_id) {
                        userSet.add(item.payload.user_id);
                    }
                });
            }

            document.getElementById('vector-total-count').textContent = totalCount;
            document.getElementById('vector-points-count').textContent = pointsCount;
            document.getElementById('vector-dimension').textContent = dimension;
            document.getElementById('vector-user-count').textContent = userSet.size;
        }

        // æ¸²æŸ“å‘é‡æ•°æ®åº“è¡¨æ ¼
        function renderVectorTable(data) {
            const container = document.getElementById('vector-data-container');

            if (data.length === 0) {
                container.innerHTML = '<div class="loading">ğŸ“­ æš‚æ— å‘é‡æ•°æ®</div>';
                return;
            }

            let html = `
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>å‘é‡ ID</th>
                                <th>ç”¨æˆ· ID</th>
                                <th>è®°å¿†å†…å®¹</th>
                                <th>Hash</th>
                                <th>åˆ›å»ºæ—¶é—´</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            data.forEach(item => {
                const payload = item.payload || {};
                const userId = payload.user_id || '-';
                const memoryData = payload.data || '-';
                const hash = payload.hash || '-';
                const createdAt = payload.created_at || '-';
                
                html += `
                    <tr>
                        <td><span class="text-truncate" title="${item.id}">${item.id.substring(0, 8)}...</span></td>
                        <td><span class="badge badge-update">${userId}</span></td>
                        <td><span class="text-truncate" title="${memoryData}">${memoryData}</span></td>
                        <td><span class="text-truncate" title="${hash}" style="font-family: monospace; font-size: 0.85em;">${hash.substring(0, 12)}...</span></td>
                        <td><span class="timestamp">${formatDateTime(createdAt)}</span></td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
            `;

            container.innerHTML = html;
        }

        // ========== å›¾æ•°æ®åº“ç›¸å…³å‡½æ•° ==========

        // åŠ è½½å›¾æ•°æ®åº“æ•°æ®
        async function loadGraphData() {
            const container = document.getElementById('graph-data-container');
            container.innerHTML = '<div class="loading">â³ æ­£åœ¨åŠ è½½å›¾æ•°æ®...</div>';

            try {
                // å‘é€ AJAX è¯·æ±‚
                const response = await fetch(`${API_BASE_URL}/query/graphdb`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();

                if (result.success && result.data) {
                    updateGraphStats(result);
                    renderGraphTables(result.data);
                } else {
                    throw new Error('æ•°æ®æ ¼å¼é”™è¯¯');
                }
            } catch (error) {
                console.error('è·å–å›¾æ•°æ®å¤±è´¥:', error);
                container.innerHTML = `
                    <div class="error">
                        âŒ åŠ è½½å›¾æ•°æ®å¤±è´¥: ${error.message}
                        <br><br>
                        è¯·ç¡®ä¿ï¼š
                        <ul style="margin-top: 10px; margin-left: 20px;">
                            <li>dashboard_server.py å·²å¯åŠ¨</li>
                            <li>å›¾æ•°æ®åº“æ–‡ä»¶å­˜åœ¨</li>
                            <li>Kuzu å®¢æˆ·ç«¯å·²å®‰è£…</li>
                        </ul>
                    </div>
                `;
            }
        }

        // æ›´æ–°å›¾æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯
        function updateGraphStats(result) {
            const nodesCount = result.nodes_count || 0;
            const relationshipsCount = result.relationships_count || 0;
            
            // ç»Ÿè®¡å®ä½“æ•°ï¼ˆæ’é™¤ç”¨æˆ·èŠ‚ç‚¹ï¼‰
            const entitiesCount = result.data.nodes ? 
                result.data.nodes.filter(node => !node.name.startsWith('user_id:')).length : 0;
            
            // è¿æ¥æ•°å°±æ˜¯å…³ç³»æ•°
            const connectionsCount = relationshipsCount;

            document.getElementById('graph-nodes-count').textContent = nodesCount;
            document.getElementById('graph-relationships-count').textContent = relationshipsCount;
            document.getElementById('graph-entities-count').textContent = entitiesCount;
            document.getElementById('graph-connections-count').textContent = connectionsCount;
        }

        // æ¸²æŸ“å›¾æ•°æ®åº“è¡¨æ ¼
        function renderGraphTables(data) {
            const container = document.getElementById('graph-data-container');

            if (!data.nodes || !data.relationships) {
                container.innerHTML = '<div class="loading">ğŸ“­ æš‚æ— å›¾æ•°æ®</div>';
                return;
            }

            let html = '';

            // èŠ‚ç‚¹è¡¨æ ¼
            if (data.nodes.length > 0) {
                html += `
                    <h3 style="margin-top: 20px; margin-bottom: 15px; color: #667eea; font-size: 1.3em;">
                        ğŸ”µ èŠ‚ç‚¹ (Nodes)
                    </h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>èŠ‚ç‚¹ ID</th>
                                    <th>ç”¨æˆ· ID</th>
                                    <th>èŠ‚ç‚¹åç§°</th>
                                    <th>æåŠæ¬¡æ•°</th>
                                    <th>åˆ›å»ºæ—¶é—´</th>
                                </tr>
                            </thead>
                            <tbody>
                `;

                data.nodes.forEach(node => {
                    const nodeId = node.id || '-';
                    const userId = node.user_id || '-';
                    const name = node.name || '-';
                    const mentions = node.mentions || 0;
                    const created = node.created || '-';
                    
                    // ä¸ºç”¨æˆ·èŠ‚ç‚¹æ·»åŠ ç‰¹æ®Šæ ·å¼
                    const isUserNode = name.startsWith('user_id:');
                    const nameDisplay = isUserNode ? 
                        `<span class="badge badge-update">${name}</span>` : 
                        `<span class="badge badge-add">${name}</span>`;
                    
                    html += `
                        <tr>
                            <td><span style="font-family: monospace;">${nodeId}</span></td>
                            <td><span class="text-truncate">${userId}</span></td>
                            <td>${nameDisplay}</td>
                            <td><span class="badge" style="background: #e3f2fd; color: #1565c0;">${mentions}</span></td>
                            <td><span class="timestamp">${formatDateTime(created)}</span></td>
                        </tr>
                    `;
                });

                html += `
                            </tbody>
                        </table>
                    </div>
                `;
            }

            // å…³ç³»è¡¨æ ¼
            if (data.relationships.length > 0) {
                html += `
                    <h3 style="margin-top: 30px; margin-bottom: 15px; color: #667eea; font-size: 1.3em;">
                        ğŸ”— å…³ç³» (Relationships)
                    </h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>æºèŠ‚ç‚¹</th>
                                    <th>å…³ç³»ç±»å‹</th>
                                    <th>ç›®æ ‡èŠ‚ç‚¹</th>
                                    <th>æåŠæ¬¡æ•°</th>
                                    <th>åˆ›å»ºæ—¶é—´</th>
                                    <th>æ›´æ–°æ—¶é—´</th>
                                </tr>
                            </thead>
                            <tbody>
                `;

                data.relationships.forEach(rel => {
                    const source = rel.source || '-';
                    const relationship = rel.relationship || '-';
                    const destination = rel.destination || '-';
                    const mentions = rel.mentions || 0;
                    const created = rel.created || '-';
                    const updated = rel.updated || '-';
                    
                    // æ ¹æ®å…³ç³»ç±»å‹è®¾ç½®ä¸åŒé¢œè‰²
                    const relationshipBadge = getRelationshipBadge(relationship);
                    
                    html += `
                        <tr>
                            <td><span class="badge badge-add">${source}</span></td>
                            <td>${relationshipBadge}</td>
                            <td><span class="badge badge-add">${destination}</span></td>
                            <td><span class="badge" style="background: #e3f2fd; color: #1565c0;">${mentions}</span></td>
                            <td><span class="timestamp">${formatDateTime(created)}</span></td>
                            <td><span class="timestamp">${updated === '-' ? updated : formatDateTime(updated)}</span></td>
                        </tr>
                    `;
                });

                html += `
                            </tbody>
                        </table>
                    </div>
                `;
            }

            if (data.nodes.length === 0 && data.relationships.length === 0) {
                html = '<div class="loading">ğŸ“­ æš‚æ— å›¾æ•°æ®</div>';
            }

            container.innerHTML = html;
        }

        // è·å–å…³ç³»ç±»å‹å¾½ç« 
        function getRelationshipBadge(relationship) {
            const relationshipColors = {
                'likes': { bg: '#d4edda', color: '#155724' },      // ç»¿è‰²
                'dislikes': { bg: '#f8d7da', color: '#721c24' },   // çº¢è‰²
                'has': { bg: '#d1ecf1', color: '#0c5460' },        // è“è‰²
                'contains': { bg: '#fff3cd', color: '#856404' },   // é»„è‰²
                'knows': { bg: '#e2e3e5', color: '#383d41' },      // ç°è‰²
            };

            const color = relationshipColors[relationship] || { bg: '#e7e7e7', color: '#333' };
            
            return `<span class="badge" style="background: ${color.bg}; color: ${color.color}; font-weight: 600;">
                ${relationship}
            </span>`;
        }

        // ========== å›¾è°±å¯è§†åŒ–ç›¸å…³å‡½æ•° ==========

        // åŠ è½½å›¾è°±å¯è§†åŒ–
        async function loadGraphVisualization() {
            const container = document.getElementById('graph-visualization');
            
            try {
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                container.innerHTML = '<div class="loading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">â³ æ­£åœ¨åŠ è½½å›¾è°±...</div>';

                // è·å–å›¾æ•°æ®
                const response = await fetch(`${API_BASE_URL}/query/graphdb`);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();

                if (result.success && result.data) {
                    graphDataCache = result.data;
                    renderGraphVisualization(result.data);
                } else {
                    throw new Error('æ•°æ®æ ¼å¼é”™è¯¯');
                }
            } catch (error) {
                console.error('åŠ è½½å›¾è°±å¤±è´¥:', error);
                container.innerHTML = `
                    <div class="error" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; text-align: center;">
                        âŒ åŠ è½½å›¾è°±å¤±è´¥: ${error.message}
                        <br><br>
                        è¯·ç¡®ä¿ dashboard_server.py å·²å¯åŠ¨
                    </div>
                `;
            }
        }

        // æ¸²æŸ“å›¾è°±å¯è§†åŒ–
        function renderGraphVisualization(data) {
            if (!data.nodes || !data.relationships) {
                const container = document.getElementById('graph-visualization');
                container.innerHTML = '<div class="loading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);">ğŸ“­ æš‚æ— å›¾æ•°æ®</div>';
                return;
            }

            // è½¬æ¢èŠ‚ç‚¹æ•°æ®ä¸º Vis.js æ ¼å¼
            const nodes = data.nodes.map(node => {
                const isUserNode = node.name.startsWith('user_id:');
                return {
                    id: node.name,  // ä½¿ç”¨ name ä½œä¸ºå”¯ä¸€æ ‡è¯†
                    label: node.name,
                    title: `ID: ${node.id || 'N/A'}\nç”¨æˆ·: ${node.user_id}\næåŠ: ${node.mentions}æ¬¡\nåˆ›å»º: ${node.created}`,
                    color: {
                        background: isUserNode ? '#FB7E81' : '#97C2FC',
                        border: isUserNode ? '#E85256' : '#2B7CE9',
                        highlight: {
                            background: isUserNode ? '#FF9B9D' : '#B3D4FF',
                            border: isUserNode ? '#FF4448' : '#1A5FCC'
                        }
                    },
                    font: {
                        size: 16,
                        color: '#333'
                    },
                    shape: isUserNode ? 'box' : 'circle',
                    value: node.mentions,  // èŠ‚ç‚¹å¤§å°æ ¹æ®æåŠæ¬¡æ•°
                    borderWidth: 2
                };
            });

            // è½¬æ¢å…³ç³»æ•°æ®ä¸º Vis.js æ ¼å¼
            const edges = data.relationships.map((rel, index) => {
                // æ ¹æ®å…³ç³»ç±»å‹è®¾ç½®é¢œè‰²
                let edgeColor;
                if (rel.relationship === 'likes') {
                    edgeColor = '#7BE141';
                } else if (rel.relationship === 'dislikes') {
                    edgeColor = '#FFA807';
                } else {
                    edgeColor = '#6E6EFD';
                }

                return {
                    id: `edge_${index}`,
                    from: rel.source,
                    to: rel.destination,
                    label: rel.relationship,
                    title: `å…³ç³»: ${rel.relationship}\næåŠ: ${rel.mentions}æ¬¡\nåˆ›å»º: ${rel.created}`,
                    arrows: {
                        to: {
                            enabled: true,
                            scaleFactor: 0.8
                        }
                    },
                    color: {
                        color: edgeColor,
                        highlight: edgeColor,
                        hover: edgeColor
                    },
                    font: {
                        size: 12,
                        align: 'middle',
                        background: 'white',
                        strokeWidth: 2,
                        strokeColor: 'white'
                    },
                    width: 2,
                    smooth: {
                        type: 'curvedCW',
                        roundness: 0.2
                    }
                };
            });

            // åˆ›å»ºç½‘ç»œå›¾æ•°æ®
            const networkData = {
                nodes: new vis.DataSet(nodes),
                edges: new vis.DataSet(edges)
            };

            // é…ç½®é€‰é¡¹
            const options = {
                nodes: {
                    scaling: {
                        min: 20,
                        max: 50,
                        label: {
                            enabled: true,
                            min: 14,
                            max: 20
                        }
                    }
                },
                edges: {
                    scaling: {
                        min: 1,
                        max: 5
                    }
                },
                physics: {
                    enabled: true,
                    stabilization: {
                        enabled: true,
                        iterations: 200
                    },
                    barnesHut: {
                        gravitationalConstant: -8000,
                        centralGravity: 0.3,
                        springLength: 150,
                        springConstant: 0.04,
                        damping: 0.09,
                        avoidOverlap: 0.5
                    }
                },
                interaction: {
                    hover: true,
                    tooltipDelay: 100,
                    zoomView: true,
                    dragView: true,
                    navigationButtons: true,
                    keyboard: {
                        enabled: true
                    }
                },
                layout: {
                    improvedLayout: true,
                    hierarchical: false
                }
            };

            // æ¸…ç©ºå®¹å™¨
            const container = document.getElementById('graph-visualization');
            container.innerHTML = '';

            // åˆ›å»ºç½‘ç»œå›¾
            networkInstance = new vis.Network(container, networkData, options);

            // æ·»åŠ äº‹ä»¶ç›‘å¬
            networkInstance.on('click', function(params) {
                if (params.nodes.length > 0) {
                    console.log('ç‚¹å‡»èŠ‚ç‚¹:', params.nodes[0]);
                }
                if (params.edges.length > 0) {
                    console.log('ç‚¹å‡»è¾¹:', params.edges[0]);
                }
            });

            // ç¨³å®šåé€‚åº”è§†å›¾
            networkInstance.once('stabilized', function() {
                networkInstance.fit({
                    animation: {
                        duration: 1000,
                        easingFunction: 'easeInOutQuad'
                    }
                });
            });
        }

        // é€‚åº”è§†å›¾
        function fitGraphView() {
            if (networkInstance) {
                networkInstance.fit({
                    animation: {
                        duration: 500,
                        easingFunction: 'easeInOutQuad'
                    }
                });
            }
        }

        // é‡æ–°å¸ƒå±€
        function resetGraphPhysics() {
            if (networkInstance) {
                networkInstance.stabilize();
            }
        }

        // åˆ‡æ¢ç‰©ç†å¼•æ“
        function togglePhysics() {
            if (networkInstance) {
                physicsEnabled = !physicsEnabled;
                networkInstance.setOptions({ physics: { enabled: physicsEnabled } });
                
                // æ˜¾ç¤ºæç¤º
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = physicsEnabled ? 'âš™ï¸ ç‰©ç†å¼•æ“ï¼šå¼€' : 'âš™ï¸ ç‰©ç†å¼•æ“ï¼šå…³';
                setTimeout(() => {
                    btn.textContent = originalText;
                }, 1500);
            }
        }

        // å¯¼å‡ºå›¾ç‰‡
        function exportGraphImage() {
            if (networkInstance) {
                try {
                    // ä½¿ç”¨ Vis.js çš„ canvas å¯¼å‡ºåŠŸèƒ½
                    const canvas = document.querySelector('#graph-visualization canvas');
                    if (canvas) {
                        canvas.toBlob(function(blob) {
                            const url = URL.createObjectURL(blob);
                            const link = document.createElement('a');
                            link.download = `knowledge-graph-${new Date().getTime()}.png`;
                            link.href = url;
                            link.click();
                            URL.revokeObjectURL(url);
                        });
                    }
                } catch (error) {
                    alert('å¯¼å‡ºå›¾ç‰‡å¤±è´¥: ' + error.message);
                }
            }
        }
    </script>
</body>
</html>